# CPU-only configuration for Chatterbox TTS API
# This file extends docker-compose.yml and overrides settings for CPU-only deployment
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.cpu.yml up
#   
# Or use the simplified command:
#   cd docker && docker compose -f docker-compose.cpu.yml up

version: '3.8'

services:
  chatterbox-tts:
    build:
      dockerfile: docker/Dockerfile
      args:
        BASE_IMAGE: python:3.11-slim
        PYTORCH_VERSION: 2.6.0
        TORCHVISION_VERSION: 0.21.0
        TORCHAUDIO_VERSION: 2.6.0
        PYTORCH_INDEX: https://download.pytorch.org/whl/cpu
        DEVICE: cpu
        NEEDS_PYTHON_INSTALL: "false"
        EXTRA_PACKAGES: ""
    container_name: chatterbox-tts-api-cpu
    environment:
      DEVICE: cpu
      TTS_MODEL_TYPE: ${TTS_MODEL_TYPE:-multilingual}
    volumes:
      - ../app:/app/app:ro
      - ../tests:/app/tests:ro
      - ../requirements.txt:/app/requirements.txt:ro
      - ../pyproject.toml:/app/pyproject.toml:ro
